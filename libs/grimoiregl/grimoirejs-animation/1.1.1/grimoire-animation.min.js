!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=12)}([function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(){function e(t){i(this,e),this.animationRecipe=t,this.clips=new Map;for(var n in t)this.clips.set(n,new a.default(t[n]))}return r(e,[{key:"getClip",value:function(e){return this.clips.get(e)}}]),e}();t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(3),u=i(a),f=n(13),c=i(f),s=n(0),l=i(s),d=function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{f(i.next(e))}catch(e){o(e)}}function u(e){try{f(i.throw(e))}catch(e){o(e)}}function f(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,u)}f((i=i.apply(e,t||[])).next())})},p=function(){function e(){r(this,e)}return o(e,null,[{key:"addAnimationType",value:function(t,n){this.animationGenerators[t]=n,e.registerdHandlers[t]&&e.registerdHandlers[t].forEach(function(e){return e()})}},{key:"addAnimation",value:function(t,n){var i=u.default.parse(n);e.addAnimationType(t,function(){return new l.default(i)})}},{key:"addAnimationFromURL",value:function(t,n){return d(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,c.default.resolve(n);case 2:r=i.sent,e.addAnimation(t,r);case 4:case"end":return i.stop()}},i,this)}))}},{key:"_onRegister",value:function(t,n){e.registerdHandlers[t]?e.registerdHandlers[t].push(n):e.registerdHandlers[t]=[n]}},{key:"instanciate",value:function(t){return d(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.animationGenerators[t]){n.next=4;break}return n.abrupt("return",e.animationGenerators[t]());case 4:return n.next=6,this._waitForRegistered(t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}},{key:"_waitForRegistered",value:function(t){return new Promise(function(n){e._onRegister(t,function(){n(e.animationGenerators[t]())})})}}]),e}();t.default=p,p.animationGenerators={},p.registerdHandlers={},p.animationTypes=[]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(9),u=i(a),f=n(6),c=i(f),s=function(){function e(t){r(this,e),this._clip=t,this._animationClipElements=new Map;for(var n=0;n<t.length;n++)this._animationClipElements.set(t[n].query,t[n])}return o(e,[{key:"step",value:function(e,t){for(var n=0;n<this._clip.length;n++){var i=this._clip[n],r=i.query,o=i.attribute,a=(i.component,i.timelines);if("@"===r.substr(0,1)){var f=c.default.calc(t,a);e.setAttribute(o,f)}else for(var s=e.element.querySelectorAll(r),l=0;l<s.length;l++){var d=u.default.fromElement(s.item(l)),p=c.default.calc(t,a);d.setAttribute(o,p)}}}},{key:"getElement",value:function(e){return this.Elements.get(e)}},{key:"rootElement",value:function(){return this.getElement("@")}},{key:"getLength",value:function(){for(var e=0,t=0;t<this._clip.length;t++)for(var n=this._clip[t].timelines,i=0;i<n.length;i++){var r=n[i].times;e=e<=r[r.length-1]?r[r.length-1]:e}return e}},{key:"Elements",get:function(){return this._animationClipElements}}]),e}();t.default=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(14),a=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(){function e(){i(this,e)}return r(e,null,[{key:"parse",value:function(t){var n=a.default.calcHash(t);return void 0!==e._parsedCache[n]?e._parsedCache[n]:(e._parsedCache[n]=JSON.parse(t),e._parsedCache[n])}}]),e}();t.default=u,u._parsedCache={}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=n(1),c=i(f),s=n(8),l=i(s),d=function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{f(i.next(e))}catch(e){o(e)}}function u(e){try{f(i.throw(e))}catch(e){o(e)}}function f(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,u)}f((i=i.apply(e,t||[])).next())})},p=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){if(this.__bindAttributes(),this._initTime=this.time,this._Time=this.node.getComponentInAncestor("Time"),"dynamic"===this.animation)this._ready=!0;else{if(!this.animation||"string"!=typeof this.animation)throw new Error("Animation type name must be sppecified and string");this._animationPromise=c.default.instanciate(this.animation),this._registerAttributes()}}},{key:"$update",value:function(){this._ready&&this.auto&&this._update()}},{key:"_registerAttributes",value:function(){return d(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._animationPromise;case 2:this._animation=e.sent,this._ready=!0;case 4:case"end":return e.stop()}},e,this)}))}},{key:"step",value:function(e){this._animation.getClip(this.clip).step(this.node,e)}},{key:"_update",value:function(){var e=this._animation.getClip(this.clip).getLength();this.time=this._Time.getAttribute("time")+this._initTime,this.time=this.loop?this.time%e:this.time,this._animation.getClip(this.clip).step(this.node,this.time)}},{key:"getClip",value:function(e){return this.Animation.getClip(e)}},{key:"Animation",get:function(){return this._animation},set:function(e){this._animation=e}}]),t}(l.default);t.default=p,p.attributes={animation:{converter:"String",default:null},clip:{converter:"String",default:null},auto:{converter:"Boolean",default:!0},loop:{converter:"Boolean",default:!0},time:{converter:"Number",default:0}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=n(1),c=i(f),s=n(8),l=i(s),d=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){if(this.__bindAttributes(),this.getAttributeRaw("typeName").watch(function(e){console.warn("Changeing 'typeName' on AnimationImporter makes no sense. This change won't affect anything.")}),this.getAttributeRaw("src").watch(function(e){console.warn("Changeing 'src' on AnimationImporter makes no sense. This change won't affect anything.")}),!this.typeName||!this.src)throw new Error("type or src cannot be null in Animation importer");if(c.default.animationTypes.indexOf(this.typeName)>=0)throw new Error("A Animation type '"+this.typeName+"' is already loaded.");c.default.animationTypes.push(this.typeName),c.default.addAnimationFromURL(this.typeName,this.src)}}]),t}(l.default);t.default=d,d.attributes={typeName:{default:null,converter:"String"},src:{default:null,converter:"String"}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(11),a=function(){function e(){i(this,e)}return r(e,null,[{key:"calc",value:function(e,t){for(var n=[],i=0;i<t.length;i++){var r=this._calc(e,t[i]);null===r?console.warn("Animation effect type is not defined"):n.push(r)}return n}},{key:"_decideTimelinePosition",value:function(e,t){var n=0,i=t.length-1,r=void 0;if(e<t[n])return n;if(e>t[i])return i;for(;i-n>1;){if(r=Math.floor((n+i)/2),t[r]===e)return r;t[r]<e?n=r:e<t[r]&&(i=r)}return n}},{key:"_calc",value:function(e,t){var n=this._decideTimelinePosition(e,t.times);if(t.values.length-1===n)return t.values[n];if(void 0===t.effects){t.effects=[];for(var i=0;i<t.times.length-1;i++)t.effects.push({type:o.EffectName.LINEAR})}if(t.effects[n].type===o.EffectName.LINEAR){var r=t.values[n],a=t.values[n+1],u=t.times[n];return(a-r)*(e-u)/(t.times[n+1]-u)+r}return t.effects[n].type===o.EffectName.LINEAR?t.values[n]:(t.effects[n].type,o.EffectName.BEZIER,null)}}]),e}();t.default=a},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.Component},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.GomlNode},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){if(this instanceof d.default)this.forEach(function(i){return i.animate(e,t,n)});else{for(var i=this.addComponent("Animation",{animation:"dynamic",clip:"dynamic"}),r=[],o=0;o<this.getAttributeRaw(e)._value.length;o++)r[o]={times:[0,n],values:[this.getAttributeRaw(e)._value[o],t[o]]};console.log(r);var a={dynamic:[{query:"@",component:this.getAttributeRaw("position").component.name.name,attribute:e,timelines:r}]};i.Animation=new y.default(a)}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=i(o),u=n(5),f=i(u),c=n(4),s=i(c),l=n(15),d=i(l),p=n(9),m=i(p),h=n(0),y=i(h),v=function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{f(i.next(e))}catch(e){o(e)}}function u(e){try{f(i.throw(e))}catch(e){o(e)}}function f(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,u)}f((i=i.apply(e,t||[])).next())})};t.default=function(){a.default.register(function(){return v(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.default.registerNode("import-animation",["AnimationImporter"]),a.default.registerComponent("Animation",s.default),a.default.registerComponent("AnimationImporter",f.default),a.default.prototype.constructor.Interface.NodeInterface.prototype.animate=r,m.default.prototype.animate=r;case 5:case"end":return e.stop()}},e,this)}))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.EffectName=void 0;!function(e){e.LINEAR="LINEAR",e.DESCRETE="DESCRETE",e.BEZIER="BEZIER"}(i||(t.EffectName=i={})),t.default=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=i(r),a=n(0),u=i(a),f=n(2),c=i(f),s=n(1),l=i(s),d=n(3),p=i(d),m=n(4),h=i(m),y=n(5),v=i(y),_=n(6),b=i(_),g=n(10),w=i(g),E={Animation:{Animation:u.default,AnimationClip:c.default,AnimationFactory:l.default,AnimationParser:p.default},Components:{AnimationComponent:h.default,AnimationImporterComponent:v.default},Util:{TimelineCalculator:b.default}};o.default.notifyRegisteringPlugin("grimoirejs-animation");var A=(0,w.default)();Object.assign(E,{__VERSION__:"1.1.1",__NAME__:"grimoirejs-animation"}),Object.assign(A||{},E),window.GrimoireJS.lib.animation=E,t.default=A},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.fundamental.Asset.TextFileResolver},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.fundamental.Util.HashCalculator},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Interface.NodeInterface}])});